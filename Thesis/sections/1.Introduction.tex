% !TEX root = ../main.tex
\chapter{Introduction}\label{ch:Introduction}

\section{Problem statement}

\subsection{Context}
Currently, there are many open-source libraries available for developers to reuse the features that these libraries implement. This practice is becoming more and more popular since it allows to reuse previously developed code, and helps developers avoid implementing the same functionalities multiple times.

When a developer uses an open-source library in a project, it creates a dependency between the project and the library. This implies that a significant number of projects depend on other open-source projects, and it adds the task of managing these dependencies to the maintenance tasks of the project.  Proper maintenance of the dependencies of a project is also part of the health and security of software applications, and it is one of the problems that the field of software engineering is trying to solve \cite{kula2014visualizing}. For instance, an update of a dependency can involve changing part of the code, if the update contains breaking changes \cite{Raemaekers2017}. % In addition, vulnerabilities may appear in the dependencies which can affect the project, and therefore need to be addressed.

The management and maintenance of the dependencies of a project is an important task. Open-source libraries \unsure{"for example, ..."; you may also mention some other reasons for updating libs}, just like any other software product, can have security vulnerabilities that may affect the projects that depend on these libraries. For example, some vulnerabilities can become security problems that can have a negative impact in terms of integrity, privacy or availability.

% TODO: afegir algo sobre el impacte dels canvis

\blankl % Pensar si segueixo posant aixo en cas que no faci la pregunta dos
Currently, developers have package managers at their disposal, to ease the task of managing the dependencies of their projects. However, the dependency management available in these package managers only evaluate if a dependency exists or not and a more detailed risk evaluation is missing \cite{hejderup2018prazi}. There is no way to evaluate how much a project depends on a library.

Furthermore, the developers of a project may decide to replace one of the dependencies of the project with another one. This could happen in case a library has vulnerabilities or is deprecated, to prevent the vulnerabilities from affecting the project. However, replacing a dependency could be a costly process. It involves identifying which parts of the project are affected by the dependency, and which parts of the library are being used and need replacement. Moreover, in the case of the transitive dependencies, determining which parts of the project are affected by the dependency becomes more complex.

\blankl
Therefore, this thesis has the aim to perform a more detailed evaluation of the \textit{actual usage} of the dependencies. A set of metrics is proposed to measure the dependencies between projects and the libraries these use. In addition, we want to propose a way to estimate the impact of replacing a dependency, considering which parts of the code are affected by the it.\reminder{Review once I know what I have achieved.}

\subsection{Host organization}
This project has been carried out in collaboration with the company \textit{Software Improvement Group (SIG)}, and it is motivated by the \textit{FASTEN} project \footnote{\url{https://www.fasten-project.eu/}}. The objective of this project is to improve the quality of open-source development environments to make them more secure and reliable. For this reason, the FASTEN project aims to analyze the software library dependencies that the projects have in more detail.

\subsection{Research questions}
\unsure{Still deciding whether to use software product, or libraries, how to introduce it. Because, for the PoC I am using only libraries available in Maven, but the model is meant to be used to measure the dependencies with any type of software product}
To tackle the problems described in the previous section, we specify the following research questions:

\blankl
\textbf{RQ1:} \textit{How can we measure the degree of source code dependency between two software products?}

To define an approach to answer this question and to divide the question in different parts, we have defined the following subquestions:

\begin{itemize}
  \item \textbf{RQ1.1:} \textit{What constitutes a dependency between two products?}

  The first step to measure the degree of dependency, is to determine what creates a dependency. The type of connection between the products and how can these be counted, among other characteristics.

  \item \textbf{RQ1.2:} \textit{Which metrics can be used to measure the dependency?}

  Investigate which existing metrics could be used to measure dependency between software products, or create new ones. Evaluate the candidate metrics according to the definition of dependency. In addition, it is also necessary to define how to adapt them to the new usage, and which is the meaning of the metrics in this new scenario, how are these actionable.

  \item \textbf{RQ1.3:} \textit{How can we calculate the metrics?}

  With a defined set of metrics to use, it is necessary to calculate them, to have results to evaluate the metrics. There are various code analysis strategies to measure the metrics.

  \item \textbf{RQ1.4:} \textit{How can we validate the proposed metrics?}

  There are two approaches to validate the suitability of the metrics, the theoretical and the empirical. The metrics will be validated using both approaches.
\end{itemize}

\blankl
\textbf{RQ2:} \textit{How can we measure the effort required to replace the use of a library in a software product?}
\discussion{Lodewijk: As I wrote above, you may consider to use the term 'impact of replacing': this includes the amount of effort required, but that consists of multiple factors: 1) how much code is to be replaced 2) is there a suitable alternative library with the same (or partially) functionality; if not, how much extra stuff needs to be created 3) how many different lib calls must be substituted? 4) in how many locations of the code must these lib calls be substituted? 5) how much effort is required for each substitution? 6) how much test automation is available (this reduces the risk)...}

This second question applies to the cases where it is necessary to replace the dependency of the product with a different library. To do so, it could be useful to have an estimation of the effort needed to replace the library. To answer this question, we have defined the following subquestions:

\begin{itemize}
  \item \textbf{RQ2.1:} \textit{What do we consider effort, which is the definition?}

  There are many different definitions of effort in the literature. One of the most common ones is the hours of development effort. We are going to define which one is the effort measured in this research. \reminder{maybe rephrase this}

  \item \textbf{RQ2.2:} \textit{What does it mean to replace a dependency?}

  There are several different forms of dependency replacement. Therefore, we are going to specify a taxonomy to describe the types of library replacement, and select the relevant ones for further consideration in this thesis.

  \item \textbf{RQ2.3:} \textit{Which are the applicable methods to measure effort?}

  From all the methods and strategies to measure effort existing in the literature, we are going to chose which are the ones that measure the effort defined in RQ2.1, and are applicable to the specific situation defined in RQ2.2.

  \item \textbf{RQ2.4:} \textit{How can we validate the measurement of the effort?}

  To validate the method used to measure effort, both empirically and theoretically. Case studies are used for the empirical validation, comparing the real effort with the estimated one.
\end{itemize}

\subsection{Research method}
The main research method that is going to be employed during this project is \textit{Technical Action Research} (TAR) \cite{wieringa2012technical}.
This research method is artifact-based, which means that the first step is to produce the artifact meant to be used in certain situations envisioned by the researcher. The testing of this artifact, to see if it is effective in these situations, is done through a number of iterations. First, under ideal conditions, and then changing the experiments step by step to reach a real-world situation. These iterations, in the context of this project, are going to be limited due to the existing deadlines. However, there is the option of continuing with this part of the work in the future.

\blankl
In addition, the research will also include controlled experiments \unsure{really? what form could those take}. These experiments will be conducted as the empirical part of the validation of the coupling metrics. Additionally, the empirical validation of the effort estimation is going to be achieved by the means of case studies. In these case studies, the estimated effort will be compared with the real effort that the change required. \unsure{this seems a bit ambitious; you may replace this with the application of the measurements to one or more concrete cases (systems)}

\blankl
Some of the most difficult parts of this research \unsure{that's a bit strange to write, perhaps 'complex'} are the validation and adaptation \unsure{you have not mentioned adaptation before?
} of the coupling metrics.
First, the validation since there is not a unique way to do it, but rather a wide variety of criteria and approaches. Therefore, conducting a complete validation is a complex task as it is not possible to validate every aspect of the metric.
In addition, even though the metrics that are going to be used to measure coupling between software products already exist, they are going to be adapted. In order to use the metrics for coupling between packages \unsure{new term}, it is necessary to define the aggregation method of the metrics.\unsure{ this is not so clear...}

\blankl
After the formal definition and theoretical validation of the metrics for both, the coupling measurement and the estimation effort, to replace a library, a Proof-of-Concept (PoC) will be made. With this PoC, the metrics will be calculated for the projects given to the PoC. Once the PoC is ready, the empirical validation will be carried out for each of the metrics, by conducting controlled experiments and case studies as elaborated above.
The methodology for validating the metrics chosen during this research will be divided into two phases: a first phase of theoretical validation and a second one of empirical validation \cite{srinivasan2014software}. \unsure{this was already described above (several times)}

\section{Contributions}
Considering the current state of the art in the domain of this thesis project, the main contributions made by this research are the following:

\begin{enumerate}
	\item Applying coupling metrics to measure the coupling between two different software products, redefining the meaning \unsure{the meaning and usage of what?} and usage. Therefore, creating a methodology to measure the dependencies in a project. \unsure{??}
  \blankls

	\item Creating specific metrics for both direct and transitive library dependencies.\blankls \unsure{are these different from the coupling metrics above?}

	\item Evaluation and validation of the proposed metrics and model, by the means of a proof-of-concept tool to calculate the metrics.
\end{enumerate}

\section{Scope}\label{section:scope} % I think this is the problem analysis, but I'm not so sure
\unsure{is the background or related work?}
\subsection{Quantifying the dependencies}
To the best of our knowledge, there are no papers about measuring the degree of dependency between two separate projects. However, it is true that the degree of dependency between two classes or modules of the same project has already been measured many times, using coupling metrics \cite{briand1999unified}.

Therefore, we propose re-using the already existing coupling metrics, meant to measure the coupling between units of the \textit{same} project and adapt them to measure coupling \textit{between} projects.

\blankl
According to Poshyvanyk and Marcus in \cite{poshyvanyk2006conceptual}, there are six main groups of coupling metrics:

\begin{itemize}
  \item \textbf{Structural coupling metrics:} Measured directly from static source code analysis. Largely studied by the literature about coupling.

  \item \textbf{Dynamic coupling measures:} Measured using dynamic code analysis. \textit{"Introduced as the refinement to existing coupling measures due to gaps in addressing polymorphism, dynamic binding, and the presence of unused code by static structural coupling measures"} \cite{poshyvanyk2006conceptual}.

  \item \textbf{Evolutionary and Logical coupling:} According to Zimmermann and Diehl \cite{zimmermann2005mining}, evolutionary coupling can: \textit{"tell us which parts of the system are coupled by common changes or cochanges."}

  \item \textbf{Coupling measures based on information entropy approach:} Coupling metrics based on the information-theory approach, such as the metrics proposed by Allen and Khoshgoftaar in \cite{allen1999measuring}.

  \item \textbf{Conceptual coupling metrics:} Based on the semantic similarity between the elements. This is the focus of the work from Poshyvanyk and Marcus \cite{poshyvanyk2006conceptual}.

  \item \textbf{Coupling metrics for specific types of software applications:} Specialized coupling metrics for certain types of projects, such as knowledge-based systems or aspect-oriented approach.
\end{itemize}

\blankl
Since this research is aimed to be independent of the domain, the last cathegory is not considered in this thesis. Moreover, the evolutionary coupling is not possible to be applied in our context since it is very likely that the separate projects are not going to evolve at the same time, given that they are not developed by the same team. Finally, the research of this project, owing to the time limitation, is going to be centered on the structural metrics.

These metrics are going to be proposed as a first step to measure the degree of library dependency. Nevertheless, the metrics can be extended and calculated more accurately by adding dynamic coupling and information entropy approach metrics if time permits or in future work.


\subsection{Estimating the effort to replace a dependency}
% Escriure alguna cosa aqui, quan hagi discutit quin dels efforts estem mesurant, com i perque.

\begin{comment}
  In order to estimate the effort needed to replace a dependency in a project, there are different variables that need to be considered first:

  - How much code do I need to change - estimate based on the usage of the Dependency
  - Refactoring adjustment
  - How many methods do I need to change.
  - The impact of the change - inside the project.
\end{comment}

\subsection{Evaluation and validation} \unsure{what is the purpose of this section??? This feels a bit like 'the approach}
This thesis includes the evaluation and validation of the proposed methodology to measure dependencies and estimate the effort to replace dependencies. To do so, it is necessary to use in practice the proposed measurements. Therefore, this research includes a Proof of Concept (PoC) to use the proposed model with real projects. Then, the metrics and estimations are validated using the results obtained with the PoC.
To calculate the metrics with the PoC, it is necessary to create a dependency graph of the project that is going to be evaluated. This graph has to be a call-level dependency graph since we require a fine-grained analysis of the source code dependencies. Moreover, it has to represent the software ecosystem of the project considering the various versions of the libraries it depends on.

Ultimately, the metrics used in this project will have to be validated. There is not a unique way to validate metrics which is globally accepted and used. Therefore, various approaches will be adopted to validate the metrics as holistically as possible. In the paper \cite{srinivasan2014software}, Srinivasan et al. explain that there are two fundamental approaches for metric validation: \textit{theoretically} and \textit{empirically}. Therefore, to provide a check of validity that is as broad as possible, a mixture of these two approaches will be used during this project.

For the theoretical validity of the coupling metrics, these are validated according to the \textit{Mathematical Properties of Measures for Coupling} \cite{srinivasan2014software}.
The empirical validation of the metrics is carried out by the means of case studies. For instance, the predicted effort corresponds to the real required effort, within a certain error window. \unsure{this seems right, but different from 1.1.4?}

\section{Outline}
In Chapter \ref{ch:Background} we describe the background of this thesis based on the existing literature of the domain.
Chapter \ref{ch:TheoreticModel} describes the theoretic model of the metrics used to calculate the degree of dependency between software products and the effort needed to replace a library in a project.
The theoretic model is used in Chapter \ref{ch:PoC}, which describes the creation of the Proof-of-Concept of this model.
In Chapter \ref{ch:Experiments}, the set up and execution of the experiments is explained, and the results of the experiments are shown. These results are discussed in Chapter \ref{ch:Discussion}. Chapter \ref{ch:RelatedWork}, contains the work related to the domain of this thesis.
Finally, we present our concluding remarks in Chapter \ref{ch:Conclusion} as well as the future work.
